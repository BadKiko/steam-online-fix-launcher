# Maintainer: badkiko <badkiko@badkiko.page>
pkgname=sofl
pkgver=0.0.3
pkgrel=1
pkgdesc="Steam Online Fix Launcher - Launch all your games"
arch=('x86_64')
url="https://github.com/BadKiko/steam-online-fix-launcher"
license=('GPL-3.0-or-later')
depends=(
    'python>=3.8'
    'python-gobject'
    'gtk4>=4.15.0'
    'libadwaita>=1.6'
    'python-requests'
    'python-pillow'
    'python-cairo'
    'python-psutil'
    'python-pyxdg'
)
makedepends=(
    'meson'
    'ninja'
    'git'
)
optdepends=(
    'steam: For Steam game integration'
    'lutris: For Lutris game integration'
    'heroic-games-launcher: For Heroic game integration'
)
source=("$pkgname-$pkgver.tar.gz::https://github.com/BadKiko/steam-online-fix-launcher/archive/v$pkgver.tar.gz")
sha256sums=('SKIP')

build() {
    cd "$srcdir/steam-online-fix-launcher-$pkgver"
    meson setup build --prefix=/usr --buildtype=release -Dprofile=release -Dtiff_compression=webp
    meson compile -C build
}

package() {
    cd "$srcdir/steam-online-fix-launcher-$pkgver"
    meson install --destdir="$pkgdir" -C build

    # Install additional files
    install -Dm644 data/org.badkiko.sofl.desktop "$pkgdir/usr/share/applications/org.badkiko.sofl.desktop"
    install -Dm644 data/org.badkiko.sofl.metainfo.xml "$pkgdir/usr/share/metainfo/org.badkiko.sofl.metainfo.xml"
}
