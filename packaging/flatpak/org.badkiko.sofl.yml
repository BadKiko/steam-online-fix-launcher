app-id: org.badkiko.sofl
runtime: org.gnome.Platform
runtime-version: "48"
sdk: org.gnome.Sdk
command: sofl
finish-args:
  # X11 + Wayland
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --socket=pulseaudio
  - --socket=session-bus
  # Filesystem access
  - --filesystem=host
  - --filesystem=xdg-documents
  - --filesystem=xdg-desktop
  - --filesystem=xdg-download
  - --filesystem=xdg-data/Steam:ro
  - --filesystem=xdg-config/steam:ro
  # Device access
  - --device=all
  # Network access
  - --share=network
  - --talk-name=org.freedesktop.Notifications
  - --talk-name=org.gnome.Shell.Screenshot
  - --env=XDG_SESSION_TYPE=wayland
  - --env=GDK_BACKEND=wayland,x11

modules:
  - name: blueprint-compiler
    buildsystem: meson
    cleanup: ["*"]
    sources:
      - type: git
        url: https://gitlab.gnome.org/jwestman/blueprint-compiler
        branch: main

  - name: sofl
    buildsystem: meson
    builddir: true
    config-opts:
      - -Dprofile=release
      - -Dtiff_compression=webp
    sources:
      - type: dir
        path: ../..
